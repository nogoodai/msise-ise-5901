{
	"kics_version": "development",
	"files_scanned": 1,
	"lines_scanned": 592,
	"files_parsed": 1,
	"lines_parsed": 572,
	"lines_ignored": 20,
	"files_failed_to_scan": 0,
	"queries_total": 1088,
	"queries_failed_to_execute": 0,
	"queries_failed_to_compute_similarity_id": 0,
	"scan_id": "console",
	"severity_counters": {
		"CRITICAL": 0,
		"HIGH": 0,
		"INFO": 8,
		"LOW": 6,
		"MEDIUM": 4,
		"TRACE": 0
	},
	"total_counter": 18,
	"total_bom_resources": 0,
	"start": "2025-02-13T08:25:46.80301844-06:00",
	"end": "2025-02-13T08:25:57.092416997-06:00",
	"paths": [
		"Llama-3-3-70B-Instruct-oxqir_0.7_aws-refarch-wordpress_2025-01-01_19-08-51.tf.rescanned.tf",
		"/home/lj/kics/assets/queries/"
	],
	"queries": [
		{
			"query_name": "CloudWatch Log Group Without KMS",
			"query_id": "0afbcfe9-d341-4b92-a64c-7e6de0543879",
			"query_url": "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudwatch_log_group",
			"severity": "MEDIUM",
			"platform": "Terraform",
			"cwe": "311",
			"cloud_provider": "AWS",
			"category": "Encryption",
			"experimental": false,
			"description": "AWS CloudWatch Log groups should be encrypted using KMS",
			"description_id": "4258abe6",
			"files": [
				{
					"file_name": "Llama-3-3-70B-Instruct-oxqir_0.7_aws-refarch-wordpress_2025-01-01_19-08-51.tf.rescanned.tf",
					"similarity_id": "95fc986a4affd880d5b498e60668bee1488655f19be077a6b9fe75e0b47def20",
					"line": 517,
					"resource_type": "aws_cloudwatch_log_group",
					"resource_name": "WordPressLogGroup",
					"issue_type": "MissingAttribute",
					"search_key": "aws_cloudwatch_log_group[wordpress_log_group]",
					"search_line": -1,
					"search_value": "",
					"expected_value": "Attribute 'kms_key_id' should be set",
					"actual_value": "Attribute 'kms_key_id' is undefined"
				}
			]
		},
		{
			"query_name": "ElastiCache Redis Cluster Without Backup",
			"query_id": "8fdb08a0-a868-4fdf-9c27-ccab0237f1ab",
			"query_url": "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elasticache_cluster#snapshot_retention_limit",
			"severity": "MEDIUM",
			"platform": "Terraform",
			"cwe": "754",
			"cloud_provider": "AWS",
			"category": "Backup",
			"experimental": false,
			"description": "ElastiCache Redis cluster should have 'snapshot_retention_limit' higher than 0",
			"description_id": "0ebd9005",
			"files": [
				{
					"file_name": "Llama-3-3-70B-Instruct-oxqir_0.7_aws-refarch-wordpress_2025-01-01_19-08-51.tf.rescanned.tf",
					"similarity_id": "905b27e4eaa66fac821ca334f7c28c232518777e423fe9416e4efa4e178c27be",
					"line": 554,
					"resource_type": "aws_elasticache_cluster",
					"resource_name": "wordpress-elasticache",
					"issue_type": "MissingAttribute",
					"search_key": "aws_elasticache_cluster[wordpress_elasticache]",
					"search_line": 554,
					"search_value": "",
					"expected_value": "'snapshot_retention_limit' should be higher than 0",
					"actual_value": "'snapshot_retention_limit' is undefined",
					"remediation": "snapshot_retention_limit = 5",
					"remediation_type": "addition"
				}
			]
		},
		{
			"query_name": "VPC FlowLogs Disabled",
			"query_id": "f83121ea-03da-434f-9277-9cd247ab3047",
			"query_url": "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/vpc",
			"severity": "MEDIUM",
			"platform": "Terraform",
			"cwe": "778",
			"cloud_provider": "AWS",
			"category": "Observability",
			"experimental": false,
			"description": "Every VPC resource should have an associated Flow Log",
			"description_id": "cdbdeb30",
			"files": [
				{
					"file_name": "Llama-3-3-70B-Instruct-oxqir_0.7_aws-refarch-wordpress_2025-01-01_19-08-51.tf.rescanned.tf",
					"similarity_id": "d628a97f6444f51f45120aaf6bf9fbe69783926697419e0b7f7ca65701d0ca68",
					"line": 109,
					"resource_type": "aws_vpc",
					"resource_name": "wordpress_vpc",
					"issue_type": "IncorrectValue",
					"search_key": "aws_vpc[wordpress_vpc]",
					"search_line": 109,
					"search_value": "",
					"expected_value": "aws_vpc[wordpress_vpc] should be the same as Flow Logs VPC id",
					"actual_value": "aws_vpc[wordpress_vpc] is not the same as Flow Logs VPC id"
				}
			]
		},
		{
			"query_name": "VPC Without Network Firewall",
			"query_id": "fd632aaf-b8a1-424d-a4d1-0de22fd3247a",
			"query_url": "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/networkfirewall_firewall#vpc_id",
			"severity": "MEDIUM",
			"platform": "Terraform",
			"cwe": "311",
			"cloud_provider": "AWS",
			"category": "Networking and Firewall",
			"experimental": false,
			"description": "VPC should have a Network Firewall associated",
			"description_id": "2e7d55e6",
			"files": [
				{
					"file_name": "Llama-3-3-70B-Instruct-oxqir_0.7_aws-refarch-wordpress_2025-01-01_19-08-51.tf.rescanned.tf",
					"similarity_id": "edcf97292579feca6d9c4991f25ff08d255828ba18a32e3f64eb682a66bbee73",
					"line": 109,
					"resource_type": "aws_vpc",
					"resource_name": "wordpress_vpc",
					"issue_type": "MissingAttribute",
					"search_key": "aws_vpc[wordpress_vpc]",
					"search_line": 109,
					"search_value": "",
					"expected_value": "aws_vpc[wordpress_vpc] has an 'aws_networkfirewall_firewall' associated",
					"actual_value": "aws_vpc[wordpress_vpc] does not have an 'aws_networkfirewall_firewall' associated"
				}
			]
		},
		{
			"query_name": "EFS Without KMS",
			"query_id": "25d251f3-f348-4f95-845c-1090e41a615c",
			"query_url": "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/efs_file_system#kms_key_id",
			"severity": "LOW",
			"platform": "Terraform",
			"cwe": "311",
			"cloud_provider": "AWS",
			"category": "Encryption",
			"experimental": false,
			"description": "Amazon Elastic Filesystem should have filesystem encryption enabled using KMS CMK customer-managed keys instead of AWS managed-keys",
			"description_id": "c5dfddad",
			"files": [
				{
					"file_name": "Llama-3-3-70B-Instruct-oxqir_0.7_aws-refarch-wordpress_2025-01-01_19-08-51.tf.rescanned.tf",
					"similarity_id": "f645f9d131af53c0b0dbf2479129436e861887089010e758cccf10a24cad76f4",
					"line": 538,
					"resource_type": "aws_efs_file_system",
					"resource_name": "WordPressEFS",
					"issue_type": "MissingAttribute",
					"search_key": "aws_efs_file_system[wordpress_efs]",
					"search_line": -1,
					"search_value": "",
					"expected_value": "aws_efs_file_system[wordpress_efs].kms_key_id' should be defined'",
					"actual_value": "aws_efs_file_system[wordpress_efs].kms_key_id' is undefined"
				}
			]
		},
		{
			"query_name": "ElastiCache Using Default Port",
			"query_id": "5d89db57-8b51-4b38-bb76-b9bd42bd40f0",
			"query_url": "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elasticache_cluster#port",
			"severity": "LOW",
			"platform": "Terraform",
			"cwe": "284",
			"cloud_provider": "AWS",
			"category": "Networking and Firewall",
			"experimental": false,
			"description": "ElastiCache should not use the default port (an attacker can easily guess the port). For engine set to Redis, the default port is 6379. The Memcached default port is 11211",
			"description_id": "86cc0d57",
			"files": [
				{
					"file_name": "Llama-3-3-70B-Instruct-oxqir_0.7_aws-refarch-wordpress_2025-01-01_19-08-51.tf.rescanned.tf",
					"similarity_id": "e2f24b46eb7e3d478e8c80b37086b6b3c812650b08c5665f4ecaed78da0c66ce",
					"line": 560,
					"resource_type": "aws_elasticache_cluster",
					"resource_name": "wordpress-elasticache",
					"issue_type": "IncorrectValue",
					"search_key": "aws_elasticache_cluster[wordpress_elasticache].port",
					"search_line": 560,
					"search_value": "",
					"expected_value": "'port' should not be set to 6379",
					"actual_value": "'port' is set to 6379"
				}
			]
		},
		{
			"query_name": "ElastiCache Without VPC",
			"query_id": "8c849af7-a399-46f7-a34c-32d3dc96f1fc",
			"query_url": "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elasticache_cluster#subnet_group_name",
			"severity": "LOW",
			"platform": "Terraform",
			"cwe": "284",
			"cloud_provider": "AWS",
			"category": "Networking and Firewall",
			"experimental": false,
			"description": "ElastiCache should be launched in a Virtual Private Cloud (VPC)",
			"description_id": "cf79a8df",
			"files": [
				{
					"file_name": "Llama-3-3-70B-Instruct-oxqir_0.7_aws-refarch-wordpress_2025-01-01_19-08-51.tf.rescanned.tf",
					"similarity_id": "59779c921104c38ab4afdb5f99abbfb4611a29cf9088bc93fc72155efc75361d",
					"line": 554,
					"resource_type": "aws_elasticache_cluster",
					"resource_name": "wordpress-elasticache",
					"issue_type": "MissingAttribute",
					"search_key": "aws_elasticache_cluster[wordpress_elasticache]",
					"search_line": 554,
					"search_value": "",
					"expected_value": "'aws_elasticache_cluster[wordpress_elasticache].subnet_group_name' should be defined and not null'",
					"actual_value": "'aws_elasticache_cluster[wordpress_elasticache].subnet_group_name' is undefined or null"
				}
			]
		},
		{
			"query_name": "IAM Access Analyzer Not Enabled",
			"query_id": "e592a0c5-5bdb-414c-9066-5dba7cdea370",
			"query_url": "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/accessanalyzer_analyzer",
			"severity": "LOW",
			"platform": "Terraform",
			"cwe": "710",
			"cloud_provider": "AWS",
			"category": "Best Practices",
			"experimental": false,
			"description": "IAM Access Analyzer should be enabled and configured to continuously monitor resource permissions",
			"description_id": "d03e85ae",
			"files": [
				{
					"file_name": "Llama-3-3-70B-Instruct-oxqir_0.7_aws-refarch-wordpress_2025-01-01_19-08-51.tf.rescanned.tf",
					"similarity_id": "aa346cd1642a83b40e221f96a43d88dbfacecdf1f8e5314c24145f8d35530197",
					"line": 109,
					"resource_type": "n/a",
					"resource_name": "n/a",
					"issue_type": "MissingAttribute",
					"search_key": "resource",
					"search_line": -1,
					"search_value": "",
					"expected_value": "'aws_accessanalyzer_analyzer' should be set",
					"actual_value": "'aws_accessanalyzer_analyzer' is undefined"
				}
			]
		},
		{
			"query_name": "S3 Bucket Without Enabled MFA Delete",
			"query_id": "c5b31ab9-0f26-4a49-b8aa-4cc064392f4d",
			"query_url": "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#mfa_delete",
			"severity": "LOW",
			"platform": "Terraform",
			"cwe": "710",
			"cloud_provider": "AWS",
			"category": "Insecure Configurations",
			"experimental": false,
			"description": "S3 bucket without MFA Delete Enabled. MFA delete cannot be enabled through Terraform, it can be done by adding a MFA device (https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_mfa_enable.html) and enabling versioning and MFA delete by using AWS CLI: 'aws s3api put-bucket-versioning --versioning-configuration=Status=Enabled,MFADelete=Enabled --bucket=\u003cBUCKET_NAME\u003e --mfa=\u003cMFA_SERIAL_NUMBER\u003e'. Please, also notice that MFA delete can not be used with lifecycle configurations",
			"description_id": "e1699d08",
			"files": [
				{
					"file_name": "Llama-3-3-70B-Instruct-oxqir_0.7_aws-refarch-wordpress_2025-01-01_19-08-51.tf.rescanned.tf",
					"similarity_id": "951af56f024d5137a061ef457b4c03603dc319db0ca6a719998bbe0214e7b56b",
					"line": 442,
					"resource_type": "aws_s3_bucket",
					"resource_name": "example.com",
					"issue_type": "MissingAttribute",
					"search_key": "aws_s3_bucket[wordpress_bucket].versioning",
					"search_line": 442,
					"search_value": "",
					"expected_value": "'mfa_delete' should be set to true",
					"actual_value": "'mfa_delete' is undefined or null"
				}
			]
		},
		{
			"query_name": "Shield Advanced Not In Use",
			"query_id": "084c6686-2a70-4710-91b1-000393e54c12",
			"query_url": "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/shield_protection#resource_arn",
			"severity": "LOW",
			"platform": "Terraform",
			"cwe": "665",
			"cloud_provider": "AWS",
			"category": "Networking and Firewall",
			"experimental": false,
			"description": "AWS Shield Advanced should be used for Amazon Route 53 hosted zone, AWS Global Accelerator accelerator, Elastic IP Address, Elastic Load Balancing, and Amazon CloudFront Distribution to protect these resources against robust DDoS attacks",
			"description_id": "e09b31c7",
			"files": [
				{
					"file_name": "Llama-3-3-70B-Instruct-oxqir_0.7_aws-refarch-wordpress_2025-01-01_19-08-51.tf.rescanned.tf",
					"similarity_id": "ebd223bf1d79e222b3f33fcee0c7e60fc9f41b1254af3e173f29081785d2a615",
					"line": 380,
					"resource_type": "aws_cloudfront_distribution",
					"resource_name": "WordPressCF",
					"issue_type": "MissingAttribute",
					"search_key": "aws_cloudfront_distribution[wordpress_cf]",
					"search_line": 380,
					"search_value": "",
					"expected_value": "aws_cloudfront_distribution has shield advanced associated",
					"actual_value": "aws_cloudfront_distribution does not have shield advanced associated"
				}
			]
		},
		{
			"query_name": "EC2 Not EBS Optimized",
			"query_id": "60224630-175a-472a-9e23-133827040766",
			"query_url": "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance#ebs_optimized",
			"severity": "INFO",
			"platform": "Terraform",
			"cwe": "710",
			"cloud_provider": "AWS",
			"category": "Best Practices",
			"experimental": false,
			"description": "It's considered a best practice for an EC2 instance to use an EBS optimized instance. This provides the best performance for your EBS volumes by minimizing contention between Amazon EBS I/O and other traffic from your instance",
			"description_id": "ddce4bd9",
			"files": [
				{
					"file_name": "Llama-3-3-70B-Instruct-oxqir_0.7_aws-refarch-wordpress_2025-01-01_19-08-51.tf.rescanned.tf",
					"similarity_id": "787efd0a839aea3667a521b4807672d6e7840d66d9e9227aed00f5888fe39568",
					"line": 260,
					"resource_type": "aws_instance",
					"resource_name": "WordPressInstance",
					"issue_type": "MissingAttribute",
					"search_key": "aws_instance[{{wordpress_instance}}]",
					"search_line": 260,
					"search_value": "",
					"expected_value": "'ebs_optimized' should be set to true",
					"actual_value": "'ebs_optimized' is undefined or null",
					"remediation": "ebs_optimized = true",
					"remediation_type": "addition"
				}
			]
		},
		{
			"query_name": "Resource Not Using Tags",
			"query_id": "e38a8e0a-b88b-4902-b3fe-b0fcb17d5c10",
			"query_url": "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/guides/resource-tagging",
			"severity": "INFO",
			"platform": "Terraform",
			"cwe": "665",
			"cloud_provider": "AWS",
			"category": "Best Practices",
			"experimental": false,
			"description": "AWS services resource tags are an essential part of managing components. As a best practice, the field 'tags' should have additional tags defined other than 'Name'",
			"description_id": "09db2d52",
			"files": [
				{
					"file_name": "Llama-3-3-70B-Instruct-oxqir_0.7_aws-refarch-wordpress_2025-01-01_19-08-51.tf.rescanned.tf",
					"similarity_id": "0f7ba1fca1df9acdf148b37c65e4fe69940a5db5db104938ce1831d871c4c437",
					"line": 325,
					"resource_type": "aws_autoscaling_group",
					"resource_name": "WordPressASG",
					"issue_type": "MissingAttribute",
					"search_key": "aws_autoscaling_group[{{wordpress_asg}}]",
					"search_line": -1,
					"search_value": "",
					"expected_value": "aws_autoscaling_group[{{wordpress_asg}}].tags should be defined and not null",
					"actual_value": "aws_autoscaling_group[{{wordpress_asg}}].tags is undefined or null"
				}
			]
		},
		{
			"query_name": "Security Group Rule Without Description",
			"query_id": "68eb4bf3-f9bf-463d-b5cf-e029bb446d2e",
			"query_url": "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group#description",
			"severity": "INFO",
			"platform": "Terraform",
			"cwe": "710",
			"cloud_provider": "AWS",
			"category": "Best Practices",
			"experimental": false,
			"description": "It's considered a best practice for all rules in AWS Security Group to have a description",
			"description_id": "cee242dd",
			"files": [
				{
					"file_name": "Llama-3-3-70B-Instruct-oxqir_0.7_aws-refarch-wordpress_2025-01-01_19-08-51.tf.rescanned.tf",
					"similarity_id": "5616f53943b09cd4ee9c9f408412a11b6b53d1c7e3e9f53ea31088daad5fbcda",
					"line": 245,
					"resource_type": "aws_security_group",
					"resource_name": "RDSSG",
					"issue_type": "MissingAttribute",
					"search_key": "aws_security_group[{{rds_sg}}].egress",
					"search_line": 245,
					"search_value": "",
					"expected_value": "aws_security_group[{{rds_sg}}].egress description should be defined and not null",
					"actual_value": "aws_security_group[{{rds_sg}}].egress description is undefined or null"
				},
				{
					"file_name": "Llama-3-3-70B-Instruct-oxqir_0.7_aws-refarch-wordpress_2025-01-01_19-08-51.tf.rescanned.tf",
					"similarity_id": "a1aa40879fe04e8db84448b4afb8ded02d3b15d28b0a0f684e4972fc9b494fef",
					"line": 205,
					"resource_type": "aws_security_group",
					"resource_name": "WordPressSG",
					"issue_type": "MissingAttribute",
					"search_key": "aws_security_group[{{wordpress_sg}}].ingress",
					"search_line": 205,
					"search_value": "",
					"expected_value": "aws_security_group[{{wordpress_sg}}].ingress description should be defined and not null",
					"actual_value": "aws_security_group[{{wordpress_sg}}].ingress description is undefined or null"
				},
				{
					"file_name": "Llama-3-3-70B-Instruct-oxqir_0.7_aws-refarch-wordpress_2025-01-01_19-08-51.tf.rescanned.tf",
					"similarity_id": "cbee877af4ae01b40a9d555c683f2fcc58fa2852ec56c09a5555c9ba976bd528",
					"line": 219,
					"resource_type": "aws_security_group",
					"resource_name": "WordPressSG",
					"issue_type": "MissingAttribute",
					"search_key": "aws_security_group[{{wordpress_sg}}].egress",
					"search_line": 219,
					"search_value": "",
					"expected_value": "aws_security_group[{{wordpress_sg}}].egress description should be defined and not null",
					"actual_value": "aws_security_group[{{wordpress_sg}}].egress description is undefined or null"
				},
				{
					"file_name": "Llama-3-3-70B-Instruct-oxqir_0.7_aws-refarch-wordpress_2025-01-01_19-08-51.tf.rescanned.tf",
					"similarity_id": "e3461ef263bc2ed6e82e13148062bd0da258b7772f6b21364686e26d0a6de8f6",
					"line": 212,
					"resource_type": "aws_security_group",
					"resource_name": "WordPressSG",
					"issue_type": "MissingAttribute",
					"search_key": "aws_security_group[{{wordpress_sg}}].ingress",
					"search_line": 212,
					"search_value": "",
					"expected_value": "aws_security_group[{{wordpress_sg}}].ingress description should be defined and not null",
					"actual_value": "aws_security_group[{{wordpress_sg}}].ingress description is undefined or null"
				},
				{
					"file_name": "Llama-3-3-70B-Instruct-oxqir_0.7_aws-refarch-wordpress_2025-01-01_19-08-51.tf.rescanned.tf",
					"similarity_id": "f0d6e8ddf1c6f6adaeca8a45c41f71ed2672ec2fb9913e465f527e69a77df14b",
					"line": 198,
					"resource_type": "aws_security_group",
					"resource_name": "WordPressSG",
					"issue_type": "MissingAttribute",
					"search_key": "aws_security_group[{{wordpress_sg}}].ingress",
					"search_line": 198,
					"search_value": "",
					"expected_value": "aws_security_group[{{wordpress_sg}}].ingress description should be defined and not null",
					"actual_value": "aws_security_group[{{wordpress_sg}}].ingress description is undefined or null"
				},
				{
					"file_name": "Llama-3-3-70B-Instruct-oxqir_0.7_aws-refarch-wordpress_2025-01-01_19-08-51.tf.rescanned.tf",
					"similarity_id": "95b54f5f3f82d430affdfcdfadd05efe7c5442fdcb8aeff33195fab12915f6c6",
					"line": 238,
					"resource_type": "aws_security_group",
					"resource_name": "RDSSG",
					"issue_type": "MissingAttribute",
					"search_key": "aws_security_group[{{rds_sg}}].ingress",
					"search_line": 238,
					"search_value": "",
					"expected_value": "aws_security_group[{{rds_sg}}].ingress description should be defined and not null",
					"actual_value": "aws_security_group[{{rds_sg}}].ingress description is undefined or null"
				}
			]
		}
	]
}
