{
	"kics_version": "development",
	"files_scanned": 1,
	"lines_scanned": 329,
	"files_parsed": 1,
	"lines_parsed": 329,
	"lines_ignored": 0,
	"files_failed_to_scan": 0,
	"queries_total": 1088,
	"queries_failed_to_execute": 0,
	"queries_failed_to_compute_similarity_id": 0,
	"scan_id": "console",
	"severity_counters": {
		"CRITICAL": 0,
		"HIGH": 5,
		"INFO": 22,
		"LOW": 4,
		"MEDIUM": 14,
		"TRACE": 0
	},
	"total_counter": 45,
	"total_bom_resources": 0,
	"start": "2025-01-18T18:43:10.315405422-06:00",
	"end": "2025-01-18T18:43:16.040545017-06:00",
	"paths": [
		"gpt-4o_0.7_aws-refarch-wordpress_2025-01-14_09-53-00.tf",
		"/home/lj/kics/assets/queries/"
	],
	"queries": [
		{
			"query_name": "EFS Not Encrypted",
			"query_id": "48207659-729f-4b5c-9402-f884257d794f",
			"query_url": "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/efs_file_system#encrypted",
			"severity": "HIGH",
			"platform": "Terraform",
			"cwe": "311",
			"cloud_provider": "AWS",
			"category": "Encryption",
			"experimental": false,
			"description": "Elastic File System (EFS) must be encrypted",
			"description_id": "e4ced70d",
			"files": [
				{
					"file_name": "gpt-4o_0.7_aws-refarch-wordpress_2025-01-14_09-53-00.tf",
					"similarity_id": "62b7c733d47031a51c4c5904e01095991c9e662d78540cfeb4f1a089c8489db1",
					"line": 140,
					"resource_type": "aws_efs_file_system",
					"resource_name": "WordPressEFS",
					"issue_type": "MissingAttribute",
					"search_key": "aws_efs_file_system[wordpress_efs]",
					"search_line": -1,
					"search_value": "",
					"expected_value": "aws_efs_file_system[wordpress_efs].encrypted' should be defined and not null",
					"actual_value": "aws_efs_file_system[wordpress_efs].encrypted' is undefined or null",
					"remediation": "encrypted = true",
					"remediation_type": "addition"
				}
			]
		},
		{
			"query_name": "Sensitive Port Is Exposed To Entire Network",
			"query_id": "381c3f2a-ef6f-4eff-99f7-b169cda3422c",
			"query_url": "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group",
			"severity": "HIGH",
			"platform": "Terraform",
			"cwe": "200",
			"cloud_provider": "AWS",
			"category": "Networking and Firewall",
			"experimental": false,
			"description": "A sensitive port, such as port 23 or port 110, is open for the whole network in either TCP or UDP protocol",
			"description_id": "5be78364",
			"files": [
				{
					"file_name": "gpt-4o_0.7_aws-refarch-wordpress_2025-01-14_09-53-00.tf",
					"similarity_id": "e3bdc386522934cc5bd55507b9d69b9416d9e67cfb23ddbc3d4724c19b4d8bd2",
					"line": 78,
					"resource_type": "aws_security_group",
					"resource_name": "WebServerSG",
					"issue_type": "IncorrectValue",
					"search_key": "aws_security_group[web_sg].ingress",
					"search_line": -1,
					"search_value": "TCP,80",
					"expected_value": "HTTP (TCP:80) should not be allowed",
					"actual_value": "HTTP (TCP:80) is allowed"
				},
				{
					"file_name": "gpt-4o_0.7_aws-refarch-wordpress_2025-01-14_09-53-00.tf",
					"similarity_id": "9aaa2f1a6ff7e9577d26e33af5065cf665ee4a5351c0f7974f1d1932f4c547d6",
					"line": 78,
					"resource_type": "aws_security_group",
					"resource_name": "WebServerSG",
					"issue_type": "IncorrectValue",
					"search_key": "aws_security_group[web_sg].ingress",
					"search_line": -1,
					"search_value": "TCP,443",
					"expected_value": "HTTPS (TCP:443) should not be allowed",
					"actual_value": "HTTPS (TCP:443) is allowed"
				}
			]
		},
		{
			"query_name": "Unrestricted Security Group Ingress",
			"query_id": "4728cd65-a20c-49da-8b31-9c08b423e4db",
			"query_url": "https://www.terraform.io/docs/providers/aws/r/security_group.html",
			"severity": "HIGH",
			"platform": "Terraform",
			"cwe": "668",
			"cloud_provider": "AWS",
			"category": "Networking and Firewall",
			"experimental": false,
			"description": "Security groups allow ingress from 0.0.0.0:0 and/or ::/0",
			"description_id": "ce3ee5e0",
			"files": [
				{
					"file_name": "gpt-4o_0.7_aws-refarch-wordpress_2025-01-14_09-53-00.tf",
					"similarity_id": "182b207e46d2d479c47a9420f268137c19e570d79cc982e975e8e12c86fac681",
					"line": 88,
					"resource_type": "aws_security_group",
					"resource_name": "WebServerSG",
					"issue_type": "IncorrectValue",
					"search_key": "aws_security_group[web_sg]",
					"search_line": 88,
					"search_value": "",
					"expected_value": "One of 'ingress.cidr_blocks' not equal '0.0.0.0/0'",
					"actual_value": "One of 'ingress.cidr_blocks' equal '0.0.0.0/0'"
				},
				{
					"file_name": "gpt-4o_0.7_aws-refarch-wordpress_2025-01-14_09-53-00.tf",
					"similarity_id": "9320ecd63decf4a495458a9015a0aecd9b81b01444c434317b35dc02fffa6706",
					"line": 82,
					"resource_type": "aws_security_group",
					"resource_name": "WebServerSG",
					"issue_type": "IncorrectValue",
					"search_key": "aws_security_group[web_sg]",
					"search_line": 82,
					"search_value": "",
					"expected_value": "One of 'ingress.cidr_blocks' not equal '0.0.0.0/0'",
					"actual_value": "One of 'ingress.cidr_blocks' equal '0.0.0.0/0'"
				}
			]
		},
		{
			"query_name": "Auto Scaling Group With No Associated ELB",
			"query_id": "8e94dced-9bcc-4203-8eb7-7e41202b2505",
			"query_url": "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/autoscaling_group#load_balancers",
			"severity": "MEDIUM",
			"platform": "Terraform",
			"cwe": "400",
			"cloud_provider": "AWS",
			"category": "Availability",
			"experimental": false,
			"description": "AWS Auto Scaling Groups must have associated ELBs to ensure high availability and improve application performance. This means the attribute 'load_balancers' must be defined and not empty.",
			"description_id": "268307dd",
			"files": [
				{
					"file_name": "gpt-4o_0.7_aws-refarch-wordpress_2025-01-14_09-53-00.tf",
					"similarity_id": "b42e0a3c4d8ec11a40487fa8edb437ed23a78ad049b22cf4142b0ded9ae2bfe8",
					"line": 184,
					"resource_type": "aws_autoscaling_group",
					"resource_name": "wordpress_asg",
					"issue_type": "MissingAttribute",
					"search_key": "aws_autoscaling_group[wordpress_asg]",
					"search_line": 184,
					"search_value": "",
					"expected_value": "aws_autoscaling_group[wordpress_asg].load_balancers should be set and not empty",
					"actual_value": "aws_autoscaling_group[wordpress_asg].load_balancers is undefined"
				}
			]
		},
		{
			"query_name": "CloudFront Logging Disabled",
			"query_id": "94690d79-b3b0-43de-b656-84ebef5753e5",
			"query_url": "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudfront_distribution",
			"severity": "MEDIUM",
			"platform": "Terraform",
			"cwe": "778",
			"cloud_provider": "AWS",
			"category": "Observability",
			"experimental": false,
			"description": "AWS CloudFront distributions should have logging enabled to collect all viewer requests, which means the attribute 'logging_config' should be defined",
			"description_id": "9cf96455",
			"files": [
				{
					"file_name": "gpt-4o_0.7_aws-refarch-wordpress_2025-01-14_09-53-00.tf",
					"similarity_id": "65b4f01c0c6c80f8d9c8e8ab25c1e6d2a23940cc951fa8dbc19e303d6e39e621",
					"line": 244,
					"resource_type": "aws_cloudfront_distribution",
					"resource_name": "wordpress_cf",
					"issue_type": "MissingAttribute",
					"search_key": "aws_cloudfront_distribution[wordpress_cf]",
					"search_line": -1,
					"search_value": "",
					"expected_value": "aws_cloudfront_distribution[wordpress_cf].logging_config should be defined",
					"actual_value": "aws_cloudfront_distribution[wordpress_cf].logging_config is undefined"
				}
			]
		},
		{
			"query_name": "CloudFront Without Minimum Protocol TLS 1.2",
			"query_id": "00e5e55e-c2ff-46b3-a757-a7a1cd802456",
			"query_url": "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudfront_distribution",
			"severity": "MEDIUM",
			"platform": "Terraform",
			"cwe": "326",
			"cloud_provider": "AWS",
			"category": "Insecure Configurations",
			"experimental": false,
			"description": "CloudFront Minimum Protocol version should be at least TLS 1.2",
			"description_id": "0b620722",
			"files": [
				{
					"file_name": "gpt-4o_0.7_aws-refarch-wordpress_2025-01-14_09-53-00.tf",
					"similarity_id": "5b8b48a8f2106f20fc2ccf62f35ac4f9c9db5308b88f4608e083b6c7dfdcb48f",
					"line": 269,
					"resource_type": "aws_cloudfront_distribution",
					"resource_name": "WordPressCF",
					"issue_type": "IncorrectValue",
					"search_key": "resource.aws_cloudfront_distribution[wordpress_cf].viewer_certificate.cloudfront_default_certificate",
					"search_line": 269,
					"search_value": "",
					"expected_value": "resource.aws_cloudfront_distribution[wordpress_cf].viewer_certificate.cloudfront_default_certificate' should be 'false'",
					"actual_value": "resource.aws_cloudfront_distribution[wordpress_cf].viewer_certificate.cloudfront_default_certificate' is 'true'",
					"remediation": "{\"after\":\"false\",\"before\":\"true\"}",
					"remediation_type": "replacement"
				}
			]
		},
		{
			"query_name": "CloudFront Without WAF",
			"query_id": "1419b4c6-6d5c-4534-9cf6-6a5266085333",
			"query_url": "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudfront_distribution",
			"severity": "MEDIUM",
			"platform": "Terraform",
			"cwe": "778",
			"cloud_provider": "AWS",
			"category": "Networking and Firewall",
			"experimental": false,
			"description": "All AWS CloudFront distributions should be integrated with the Web Application Firewall (AWS WAF) service",
			"description_id": "8fa5ef1b",
			"files": [
				{
					"file_name": "gpt-4o_0.7_aws-refarch-wordpress_2025-01-14_09-53-00.tf",
					"similarity_id": "fd7a1d017e523f3d72c11d7f0005a7c10faef0320c033731aa0937b17d80908b",
					"line": 244,
					"resource_type": "aws_cloudfront_distribution",
					"resource_name": "WordPressCF",
					"issue_type": "MissingAttribute",
					"search_key": "aws_cloudfront_distribution[wordpress_cf].web_acl_id",
					"search_line": -1,
					"search_value": "",
					"expected_value": "'web_acl_id'  should exist",
					"actual_value": "'web_acl_id' is missing"
				}
			]
		},
		{
			"query_name": "EC2 Instance Has Public IP",
			"query_id": "5a2486aa-facf-477d-a5c1-b010789459ce",
			"query_url": "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance#associate_public_ip_address",
			"severity": "MEDIUM",
			"platform": "Terraform",
			"cwe": "200",
			"cloud_provider": "AWS",
			"category": "Networking and Firewall",
			"experimental": false,
			"description": "EC2 Instance should not have a public IP address.",
			"description_id": "c6f1d1f4",
			"files": [
				{
					"file_name": "gpt-4o_0.7_aws-refarch-wordpress_2025-01-14_09-53-00.tf",
					"similarity_id": "9b8af978b0a77de9f952293748f0fe36a50c9590ecf78f883063acd3ba0a945b",
					"line": 125,
					"resource_type": "aws_instance",
					"resource_name": "BastionHost",
					"issue_type": "IncorrectValue",
					"search_key": "aws_instance.bastion_host.associate_public_ip_address",
					"search_line": 125,
					"search_value": "",
					"expected_value": "'associate_public_ip_address' should be set to false",
					"actual_value": "'associate_public_ip_address' is true"
				}
			]
		},
		{
			"query_name": "EC2 Instance Monitoring Disabled",
			"query_id": "23b70e32-032e-4fa6-ba5c-82f56b9980e6",
			"query_url": "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance#monitoring",
			"severity": "MEDIUM",
			"platform": "Terraform",
			"cwe": "778",
			"cloud_provider": "AWS",
			"category": "Observability",
			"experimental": false,
			"description": "EC2 Instance should have detailed monitoring enabled. With detailed monitoring enabled data is available in 1-minute periods",
			"description_id": "0d5413e6",
			"files": [
				{
					"file_name": "gpt-4o_0.7_aws-refarch-wordpress_2025-01-14_09-53-00.tf",
					"similarity_id": "47c11171eabbb9d0b73e27f03442971a7cd05a43c1bfeae4af1f395c7d661f0d",
					"line": 120,
					"resource_type": "aws_instance",
					"resource_name": "BastionHost",
					"issue_type": "MissingAttribute",
					"search_key": "aws_instance.{{bastion_host}}",
					"search_line": 120,
					"search_value": "",
					"expected_value": "'monitoring' should be defined and not null",
					"actual_value": "'monitoring' is undefined or null",
					"remediation": "monitoring = true",
					"remediation_type": "addition"
				}
			]
		},
		{
			"query_name": "ELB Access Log Disabled",
			"query_id": "20018359-6fd7-4d05-ab26-d4dffccbdf79",
			"query_url": "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elb#enabled",
			"severity": "MEDIUM",
			"platform": "Terraform",
			"cwe": "778",
			"cloud_provider": "AWS",
			"category": "Observability",
			"experimental": false,
			"description": "ELB should have logging enabled to help on error investigation",
			"description_id": "c745bca6",
			"files": [
				{
					"file_name": "gpt-4o_0.7_aws-refarch-wordpress_2025-01-14_09-53-00.tf",
					"similarity_id": "76a7ddccf977008c53b87376a6fdb549865673190fbb0a9d40b689aaff18972f",
					"line": 156,
					"resource_type": "aws_elb",
					"resource_name": "WordPressELB",
					"issue_type": "MissingAttribute",
					"search_key": "aws_elb[{{wordpress_elb}}]",
					"search_line": 156,
					"search_value": "",
					"expected_value": "'aws_elb[{{wordpress_elb}}].access_logs' should be defined and not null",
					"actual_value": "'aws_elb[{{wordpress_elb}}].access_logs' is undefined or null",
					"remediation": "access_logs {\n\t\tenabled = true\n\t}",
					"remediation_type": "addition"
				}
			]
		},
		{
			"query_name": "HTTP Port Open To Internet",
			"query_id": "ffac8a12-322e-42c1-b9b9-81ff85c39ef7",
			"query_url": "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group",
			"severity": "MEDIUM",
			"platform": "Terraform",
			"cwe": "319",
			"cloud_provider": "AWS",
			"category": "Networking and Firewall",
			"experimental": false,
			"description": "The HTTP port is open to the internet in a Security Group",
			"description_id": "a829609b",
			"files": [
				{
					"file_name": "gpt-4o_0.7_aws-refarch-wordpress_2025-01-14_09-53-00.tf",
					"similarity_id": "f786e058af1487dffeb42ba0f50ebd4f7ea78c1378f3b8d0afe919fdb61a6725",
					"line": 76,
					"resource_type": "aws_security_group",
					"resource_name": "WebServerSG",
					"issue_type": "IncorrectValue",
					"search_key": "aws_security_group[web_sg]",
					"search_line": -1,
					"search_value": "",
					"expected_value": "aws_security_group.ingress shouldn't open the HTTP port (80)",
					"actual_value": "aws_security_group.ingress opens the HTTP port (80)"
				}
			]
		},
		{
			"query_name": "S3 Bucket Logging Disabled",
			"query_id": "f861041c-8c9f-4156-acfc-5e6e524f5884",
			"query_url": "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket",
			"severity": "MEDIUM",
			"platform": "Terraform",
			"cwe": "778",
			"cloud_provider": "AWS",
			"category": "Observability",
			"experimental": false,
			"description": "Server Access Logging should be enabled on S3 Buckets so that all changes are logged and trackable",
			"description_id": "fa5c7c72",
			"files": [
				{
					"file_name": "gpt-4o_0.7_aws-refarch-wordpress_2025-01-14_09-53-00.tf",
					"similarity_id": "31d990bd2ca5b7ad70f3e2d439c0404a8e75a2bc320c117bec2a2b7957f2edc5",
					"line": 276,
					"resource_type": "aws_s3_bucket",
					"resource_name": "wordpress-static-assets-${random_string.bucket_suffix.result}",
					"issue_type": "MissingAttribute",
					"search_key": "aws_s3_bucket[wordpress_assets]",
					"search_line": 276,
					"search_value": "",
					"expected_value": "'logging' should be defined and not null",
					"actual_value": "'logging' is undefined or null"
				}
			]
		},
		{
			"query_name": "S3 Bucket Without Versioning",
			"query_id": "568a4d22-3517-44a6-a7ad-6a7eed88722c",
			"query_url": "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#versioning",
			"severity": "MEDIUM",
			"platform": "Terraform",
			"cwe": "710",
			"cloud_provider": "AWS",
			"category": "Backup",
			"experimental": false,
			"description": "S3 bucket should have versioning enabled",
			"description_id": "7614ce3b",
			"files": [
				{
					"file_name": "gpt-4o_0.7_aws-refarch-wordpress_2025-01-14_09-53-00.tf",
					"similarity_id": "97efff6cffc24d9811db2eda3f2e8391a14d1da5bce56efea803667b5a5dd0c0",
					"line": 276,
					"resource_type": "aws_s3_bucket",
					"resource_name": "wordpress-static-assets-${random_string.bucket_suffix.result}",
					"issue_type": "MissingAttribute",
					"search_key": "aws_s3_bucket[wordpress_assets]",
					"search_line": 276,
					"search_value": "",
					"expected_value": "'versioning' should be true",
					"actual_value": "'versioning' is undefined or null"
				}
			]
		},
		{
			"query_name": "VPC FlowLogs Disabled",
			"query_id": "f83121ea-03da-434f-9277-9cd247ab3047",
			"query_url": "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/vpc",
			"severity": "MEDIUM",
			"platform": "Terraform",
			"cwe": "778",
			"cloud_provider": "AWS",
			"category": "Observability",
			"experimental": false,
			"description": "Every VPC resource should have an associated Flow Log",
			"description_id": "cdbdeb30",
			"files": [
				{
					"file_name": "gpt-4o_0.7_aws-refarch-wordpress_2025-01-14_09-53-00.tf",
					"similarity_id": "1ce8ad2edd115bdfc7438645a733467c60a68d09b31235bbdf20de8fe31c4f90",
					"line": 24,
					"resource_type": "aws_vpc",
					"resource_name": "wordpress_vpc",
					"issue_type": "IncorrectValue",
					"search_key": "aws_vpc[wordpress_vpc]",
					"search_line": 24,
					"search_value": "",
					"expected_value": "aws_vpc[wordpress_vpc] should be the same as Flow Logs VPC id",
					"actual_value": "aws_vpc[wordpress_vpc] is not the same as Flow Logs VPC id"
				}
			]
		},
		{
			"query_name": "VPC Subnet Assigns Public IP",
			"query_id": "52f04a44-6bfa-4c41-b1d3-4ae99a2de05c",
			"query_url": "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/subnet#map_public_ip_on_launch",
			"severity": "MEDIUM",
			"platform": "Terraform",
			"cwe": "732",
			"cloud_provider": "AWS",
			"category": "Networking and Firewall",
			"experimental": false,
			"description": "VPC Subnet should not assign public IP",
			"description_id": "2b7ea60d",
			"files": [
				{
					"file_name": "gpt-4o_0.7_aws-refarch-wordpress_2025-01-14_09-53-00.tf",
					"similarity_id": "0c2f30c843c9e980267a2389663f19f33674b1e8233831e5959f00e9eceed07d",
					"line": 43,
					"resource_type": "aws_subnet",
					"resource_name": "PublicSubnet-count.index",
					"issue_type": "IncorrectValue",
					"search_key": "aws_subnet[public_subnet].map_public_ip_on_launch",
					"search_line": 43,
					"search_value": "",
					"expected_value": "aws_subnet[public_subnet].map_public_ip_on_launch should be set to false or undefined",
					"actual_value": "aws_subnet[public_subnet].map_public_ip_on_launch is set to true",
					"remediation": "{\"after\":\"false\",\"before\":\"true\"}",
					"remediation_type": "replacement"
				}
			]
		},
		{
			"query_name": "VPC Without Network Firewall",
			"query_id": "fd632aaf-b8a1-424d-a4d1-0de22fd3247a",
			"query_url": "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/networkfirewall_firewall#vpc_id",
			"severity": "MEDIUM",
			"platform": "Terraform",
			"cwe": "311",
			"cloud_provider": "AWS",
			"category": "Networking and Firewall",
			"experimental": false,
			"description": "VPC should have a Network Firewall associated",
			"description_id": "2e7d55e6",
			"files": [
				{
					"file_name": "gpt-4o_0.7_aws-refarch-wordpress_2025-01-14_09-53-00.tf",
					"similarity_id": "c7fab942040984f73923c82579f178634ff400d3db5276449f4d982ec0d7f0de",
					"line": 24,
					"resource_type": "aws_vpc",
					"resource_name": "wordpress_vpc",
					"issue_type": "MissingAttribute",
					"search_key": "aws_vpc[wordpress_vpc]",
					"search_line": 24,
					"search_value": "",
					"expected_value": "aws_vpc[wordpress_vpc] has an 'aws_networkfirewall_firewall' associated",
					"actual_value": "aws_vpc[wordpress_vpc] does not have an 'aws_networkfirewall_firewall' associated"
				}
			]
		},
		{
			"query_name": "Vulnerable Default SSL Certificate",
			"query_id": "3a1e94df-6847-4c0e-a3b6-6c6af4e128ef",
			"query_url": "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudfront_distribution",
			"severity": "MEDIUM",
			"platform": "Terraform",
			"cwe": "295",
			"cloud_provider": "AWS",
			"category": "Insecure Defaults",
			"experimental": false,
			"description": "CloudFront web distributions should use custom (and not default) SSL certificates. Custom SSL certificates allow only defined users to access content by using an alternate domain name instead of the default one.",
			"description_id": "38579a53",
			"files": [
				{
					"file_name": "gpt-4o_0.7_aws-refarch-wordpress_2025-01-14_09-53-00.tf",
					"similarity_id": "0199d6c72dc79f1683beb63c2fe72b792d1bc2a98ed1e4ddb950cf4818caca0f",
					"line": 268,
					"resource_type": "aws_cloudfront_distribution",
					"resource_name": "WordPressCF",
					"issue_type": "IncorrectValue",
					"search_key": "aws_cloudfront_distribution[wordpress_cf].viewer_certificate",
					"search_line": -1,
					"search_value": "",
					"expected_value": "Attribute 'cloudfront_default_certificate' should be 'false' or not defined",
					"actual_value": "Attribute 'cloudfront_default_certificate' is 'true'"
				}
			]
		},
		{
			"query_name": "EFS Without KMS",
			"query_id": "25d251f3-f348-4f95-845c-1090e41a615c",
			"query_url": "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/efs_file_system#kms_key_id",
			"severity": "LOW",
			"platform": "Terraform",
			"cwe": "311",
			"cloud_provider": "AWS",
			"category": "Encryption",
			"experimental": false,
			"description": "Amazon Elastic Filesystem should have filesystem encryption enabled using KMS CMK customer-managed keys instead of AWS managed-keys",
			"description_id": "c5dfddad",
			"files": [
				{
					"file_name": "gpt-4o_0.7_aws-refarch-wordpress_2025-01-14_09-53-00.tf",
					"similarity_id": "f645f9d131af53c0b0dbf2479129436e861887089010e758cccf10a24cad76f4",
					"line": 140,
					"resource_type": "aws_efs_file_system",
					"resource_name": "WordPressEFS",
					"issue_type": "MissingAttribute",
					"search_key": "aws_efs_file_system[wordpress_efs]",
					"search_line": -1,
					"search_value": "",
					"expected_value": "aws_efs_file_system[wordpress_efs].kms_key_id' should be defined'",
					"actual_value": "aws_efs_file_system[wordpress_efs].kms_key_id' is undefined"
				}
			]
		},
		{
			"query_name": "IAM Access Analyzer Not Enabled",
			"query_id": "e592a0c5-5bdb-414c-9066-5dba7cdea370",
			"query_url": "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/accessanalyzer_analyzer",
			"severity": "LOW",
			"platform": "Terraform",
			"cwe": "710",
			"cloud_provider": "AWS",
			"category": "Best Practices",
			"experimental": false,
			"description": "IAM Access Analyzer should be enabled and configured to continuously monitor resource permissions",
			"description_id": "d03e85ae",
			"files": [
				{
					"file_name": "gpt-4o_0.7_aws-refarch-wordpress_2025-01-14_09-53-00.tf",
					"similarity_id": "aa346cd1642a83b40e221f96a43d88dbfacecdf1f8e5314c24145f8d35530197",
					"line": 24,
					"resource_type": "n/a",
					"resource_name": "n/a",
					"issue_type": "MissingAttribute",
					"search_key": "resource",
					"search_line": -1,
					"search_value": "",
					"expected_value": "'aws_accessanalyzer_analyzer' should be set",
					"actual_value": "'aws_accessanalyzer_analyzer' is undefined"
				}
			]
		},
		{
			"query_name": "Shield Advanced Not In Use",
			"query_id": "084c6686-2a70-4710-91b1-000393e54c12",
			"query_url": "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/shield_protection#resource_arn",
			"severity": "LOW",
			"platform": "Terraform",
			"cwe": "665",
			"cloud_provider": "AWS",
			"category": "Networking and Firewall",
			"experimental": false,
			"description": "AWS Shield Advanced should be used for Amazon Route 53 hosted zone, AWS Global Accelerator accelerator, Elastic IP Address, Elastic Load Balancing, and Amazon CloudFront Distribution to protect these resources against robust DDoS attacks",
			"description_id": "e09b31c7",
			"files": [
				{
					"file_name": "gpt-4o_0.7_aws-refarch-wordpress_2025-01-14_09-53-00.tf",
					"similarity_id": "093d9c72a712fe8b9733b58643231dcc63203ad341178a6ee0896d6819765069",
					"line": 244,
					"resource_type": "aws_cloudfront_distribution",
					"resource_name": "WordPressCF",
					"issue_type": "MissingAttribute",
					"search_key": "aws_cloudfront_distribution[wordpress_cf]",
					"search_line": 244,
					"search_value": "",
					"expected_value": "aws_cloudfront_distribution has shield advanced associated",
					"actual_value": "aws_cloudfront_distribution does not have shield advanced associated"
				},
				{
					"file_name": "gpt-4o_0.7_aws-refarch-wordpress_2025-01-14_09-53-00.tf",
					"similarity_id": "a354b73d82755d6276723ebc83f2ce9763732df41e5dd1e78840ba0b38c266b0",
					"line": 136,
					"resource_type": "aws_eip",
					"resource_name": "bastion_eip",
					"issue_type": "MissingAttribute",
					"search_key": "aws_eip[bastion_eip]",
					"search_line": 136,
					"search_value": "",
					"expected_value": "aws_eip has shield advanced associated",
					"actual_value": "aws_eip does not have shield advanced associated"
				}
			]
		},
		{
			"query_name": "EC2 Not EBS Optimized",
			"query_id": "60224630-175a-472a-9e23-133827040766",
			"query_url": "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance#ebs_optimized",
			"severity": "INFO",
			"platform": "Terraform",
			"cwe": "710",
			"cloud_provider": "AWS",
			"category": "Best Practices",
			"experimental": false,
			"description": "It's considered a best practice for an EC2 instance to use an EBS optimized instance. This provides the best performance for your EBS volumes by minimizing contention between Amazon EBS I/O and other traffic from your instance",
			"description_id": "ddce4bd9",
			"files": [
				{
					"file_name": "gpt-4o_0.7_aws-refarch-wordpress_2025-01-14_09-53-00.tf",
					"similarity_id": "8ff9fa3b773c348a0d8e845f26646ed82911e24800544ef874ef40e23cabcfc0",
					"line": 120,
					"resource_type": "aws_instance",
					"resource_name": "BastionHost",
					"issue_type": "MissingAttribute",
					"search_key": "aws_instance[{{bastion_host}}]",
					"search_line": 120,
					"search_value": "",
					"expected_value": "'ebs_optimized' should be set to true",
					"actual_value": "'ebs_optimized' is undefined or null",
					"remediation": "ebs_optimized = true",
					"remediation_type": "addition"
				}
			]
		},
		{
			"query_name": "Resource Not Using Tags",
			"query_id": "e38a8e0a-b88b-4902-b3fe-b0fcb17d5c10",
			"query_url": "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/guides/resource-tagging",
			"severity": "INFO",
			"platform": "Terraform",
			"cwe": "665",
			"cloud_provider": "AWS",
			"category": "Best Practices",
			"experimental": false,
			"description": "AWS services resource tags are an essential part of managing components. As a best practice, the field 'tags' should have additional tags defined other than 'Name'",
			"description_id": "09db2d52",
			"files": [
				{
					"file_name": "gpt-4o_0.7_aws-refarch-wordpress_2025-01-14_09-53-00.tf",
					"similarity_id": "3158a9e773d07354e04372fd847275cc202bc9a39094b4896ad28391fc9733f9",
					"line": 65,
					"resource_type": "aws_route_table",
					"resource_name": "PublicRouteTable",
					"issue_type": "MissingAttribute",
					"search_key": "aws_route_table[{{public_rt}}].tags",
					"search_line": -1,
					"search_value": "",
					"expected_value": "aws_route_table[{{public_rt}}].tags has additional tags defined other than 'Name'",
					"actual_value": "aws_route_table[{{public_rt}}].tags does not have additional tags defined other than 'Name'"
				},
				{
					"file_name": "gpt-4o_0.7_aws-refarch-wordpress_2025-01-14_09-53-00.tf",
					"similarity_id": "2b53662610a3c945c63794a2a9a6555aac120ff294384d4e44a4b4616f175af7",
					"line": 54,
					"resource_type": "aws_subnet",
					"resource_name": "PrivateSubnet-count.index",
					"issue_type": "MissingAttribute",
					"search_key": "aws_subnet[{{private_subnet}}].tags",
					"search_line": -1,
					"search_value": "",
					"expected_value": "aws_subnet[{{private_subnet}}].tags has additional tags defined other than 'Name'",
					"actual_value": "aws_subnet[{{private_subnet}}].tags does not have additional tags defined other than 'Name'"
				},
				{
					"file_name": "gpt-4o_0.7_aws-refarch-wordpress_2025-01-14_09-53-00.tf",
					"similarity_id": "07aed4387dd766cb96582d907c91989d6d57cf331b7f02ad1b0dd106d252dd9c",
					"line": 44,
					"resource_type": "aws_subnet",
					"resource_name": "PublicSubnet-count.index",
					"issue_type": "MissingAttribute",
					"search_key": "aws_subnet[{{public_subnet}}].tags",
					"search_line": -1,
					"search_value": "",
					"expected_value": "aws_subnet[{{public_subnet}}].tags has additional tags defined other than 'Name'",
					"actual_value": "aws_subnet[{{public_subnet}}].tags does not have additional tags defined other than 'Name'"
				},
				{
					"file_name": "gpt-4o_0.7_aws-refarch-wordpress_2025-01-14_09-53-00.tf",
					"similarity_id": "0d67567ae78f3b1f9186b39b709ed8118f0ae63b0049f833394ad1fe8181fe76",
					"line": 239,
					"resource_type": "aws_db_subnet_group",
					"resource_name": "wordpress-db-subnet-group",
					"issue_type": "MissingAttribute",
					"search_key": "aws_db_subnet_group[{{db_subnet}}].tags",
					"search_line": -1,
					"search_value": "",
					"expected_value": "aws_db_subnet_group[{{db_subnet}}].tags has additional tags defined other than 'Name'",
					"actual_value": "aws_db_subnet_group[{{db_subnet}}].tags does not have additional tags defined other than 'Name'"
				},
				{
					"file_name": "gpt-4o_0.7_aws-refarch-wordpress_2025-01-14_09-53-00.tf",
					"similarity_id": "b834189bad0dc1a962f2a8f32c25dbbf55611e40168a5362a36fb20e9422ec3f",
					"line": 279,
					"resource_type": "aws_s3_bucket",
					"resource_name": "WordPressAssets",
					"issue_type": "MissingAttribute",
					"search_key": "aws_s3_bucket[{{wordpress_assets}}].tags",
					"search_line": -1,
					"search_value": "",
					"expected_value": "aws_s3_bucket[{{wordpress_assets}}].tags has additional tags defined other than 'Name'",
					"actual_value": "aws_s3_bucket[{{wordpress_assets}}].tags does not have additional tags defined other than 'Name'"
				},
				{
					"file_name": "gpt-4o_0.7_aws-refarch-wordpress_2025-01-14_09-53-00.tf",
					"similarity_id": "6d39a4c4ff0ac38618994005ff79531ac6148aa506181da117fc78dc3470c034",
					"line": 26,
					"resource_type": "aws_vpc",
					"resource_name": "WordPressVPC",
					"issue_type": "MissingAttribute",
					"search_key": "aws_vpc[{{wordpress_vpc}}].tags",
					"search_line": -1,
					"search_value": "",
					"expected_value": "aws_vpc[{{wordpress_vpc}}].tags has additional tags defined other than 'Name'",
					"actual_value": "aws_vpc[{{wordpress_vpc}}].tags does not have additional tags defined other than 'Name'"
				},
				{
					"file_name": "gpt-4o_0.7_aws-refarch-wordpress_2025-01-14_09-53-00.tf",
					"similarity_id": "e50b320216d6eb4262bad4fb46789c4540ee522b5e6f033812635f60b21356e9",
					"line": 179,
					"resource_type": "aws_elb",
					"resource_name": "WordPressELB",
					"issue_type": "MissingAttribute",
					"search_key": "aws_elb[{{wordpress_elb}}].tags",
					"search_line": -1,
					"search_value": "",
					"expected_value": "aws_elb[{{wordpress_elb}}].tags has additional tags defined other than 'Name'",
					"actual_value": "aws_elb[{{wordpress_elb}}].tags does not have additional tags defined other than 'Name'"
				},
				{
					"file_name": "gpt-4o_0.7_aws-refarch-wordpress_2025-01-14_09-53-00.tf",
					"similarity_id": "03e670e798539090600df876eab82d5c4af905926303f408eea87131381e9731",
					"line": 271,
					"resource_type": "aws_cloudfront_distribution",
					"resource_name": "WordPressCF",
					"issue_type": "MissingAttribute",
					"search_key": "aws_cloudfront_distribution[{{wordpress_cf}}].tags",
					"search_line": -1,
					"search_value": "",
					"expected_value": "aws_cloudfront_distribution[{{wordpress_cf}}].tags has additional tags defined other than 'Name'",
					"actual_value": "aws_cloudfront_distribution[{{wordpress_cf}}].tags does not have additional tags defined other than 'Name'"
				},
				{
					"file_name": "gpt-4o_0.7_aws-refarch-wordpress_2025-01-14_09-53-00.tf",
					"similarity_id": "75535b48ebc60283ee4361076f18992873865309c5b213a58f401a2e959193f6",
					"line": 33,
					"resource_type": "aws_internet_gateway",
					"resource_name": "WordPressIGW",
					"issue_type": "MissingAttribute",
					"search_key": "aws_internet_gateway[{{igw}}].tags",
					"search_line": -1,
					"search_value": "",
					"expected_value": "aws_internet_gateway[{{igw}}].tags has additional tags defined other than 'Name'",
					"actual_value": "aws_internet_gateway[{{igw}}].tags does not have additional tags defined other than 'Name'"
				},
				{
					"file_name": "gpt-4o_0.7_aws-refarch-wordpress_2025-01-14_09-53-00.tf",
					"similarity_id": "b29c5bae0343cb97bccb8728b879a27568299715b26fb638eacd942cb2b69ca1",
					"line": 96,
					"resource_type": "aws_security_group",
					"resource_name": "WebServerSG",
					"issue_type": "MissingAttribute",
					"search_key": "aws_security_group[{{web_sg}}].tags",
					"search_line": -1,
					"search_value": "",
					"expected_value": "aws_security_group[{{web_sg}}].tags has additional tags defined other than 'Name'",
					"actual_value": "aws_security_group[{{web_sg}}].tags does not have additional tags defined other than 'Name'"
				},
				{
					"file_name": "gpt-4o_0.7_aws-refarch-wordpress_2025-01-14_09-53-00.tf",
					"similarity_id": "b1e09955cc73a9b15d7295b002f9540fd07312809c67a752f4decb281d9225a3",
					"line": 126,
					"resource_type": "aws_instance",
					"resource_name": "BastionHost",
					"issue_type": "MissingAttribute",
					"search_key": "aws_instance[{{bastion_host}}].tags",
					"search_line": -1,
					"search_value": "",
					"expected_value": "aws_instance[{{bastion_host}}].tags has additional tags defined other than 'Name'",
					"actual_value": "aws_instance[{{bastion_host}}].tags does not have additional tags defined other than 'Name'"
				},
				{
					"file_name": "gpt-4o_0.7_aws-refarch-wordpress_2025-01-14_09-53-00.tf",
					"similarity_id": "d2ae57feeffee0fab2cd96180b0a9b3b8ffcd6018446bf26365507e4b135f1be",
					"line": 115,
					"resource_type": "aws_security_group",
					"resource_name": "DatabaseSG",
					"issue_type": "MissingAttribute",
					"search_key": "aws_security_group[{{db_sg}}].tags",
					"search_line": -1,
					"search_value": "",
					"expected_value": "aws_security_group[{{db_sg}}].tags has additional tags defined other than 'Name'",
					"actual_value": "aws_security_group[{{db_sg}}].tags does not have additional tags defined other than 'Name'"
				},
				{
					"file_name": "gpt-4o_0.7_aws-refarch-wordpress_2025-01-14_09-53-00.tf",
					"similarity_id": "2f542e71c80d69ba6f8dd3446e9991b6a5c75618144ae0f5bd55ccac4fed8738",
					"line": 136,
					"resource_type": "aws_eip",
					"resource_name": "bastion_eip",
					"issue_type": "MissingAttribute",
					"search_key": "aws_eip[{{bastion_eip}}]",
					"search_line": -1,
					"search_value": "",
					"expected_value": "aws_eip[{{bastion_eip}}].tags should be defined and not null",
					"actual_value": "aws_eip[{{bastion_eip}}].tags is undefined or null"
				},
				{
					"file_name": "gpt-4o_0.7_aws-refarch-wordpress_2025-01-14_09-53-00.tf",
					"similarity_id": "cb44fc5eb649fe15b8c5d6f8ade1b6563757578b3d1002dbe671b5901ddc3ee6",
					"line": 144,
					"resource_type": "aws_efs_file_system",
					"resource_name": "WordPressEFS",
					"issue_type": "MissingAttribute",
					"search_key": "aws_efs_file_system[{{wordpress_efs}}].tags",
					"search_line": -1,
					"search_value": "",
					"expected_value": "aws_efs_file_system[{{wordpress_efs}}].tags has additional tags defined other than 'Name'",
					"actual_value": "aws_efs_file_system[{{wordpress_efs}}].tags does not have additional tags defined other than 'Name'"
				}
			]
		},
		{
			"query_name": "Security Group Rule Without Description",
			"query_id": "68eb4bf3-f9bf-463d-b5cf-e029bb446d2e",
			"query_url": "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group#description",
			"severity": "INFO",
			"platform": "Terraform",
			"cwe": "710",
			"cloud_provider": "AWS",
			"category": "Best Practices",
			"experimental": false,
			"description": "It's considered a best practice for all rules in AWS Security Group to have a description",
			"description_id": "cee242dd",
			"files": [
				{
					"file_name": "gpt-4o_0.7_aws-refarch-wordpress_2025-01-14_09-53-00.tf",
					"similarity_id": "716719e93315f335bb6e43ea87a2f8bfb606755964a2480e2e00893a4a502e48",
					"line": 109,
					"resource_type": "aws_security_group",
					"resource_name": "DatabaseSG",
					"issue_type": "MissingAttribute",
					"search_key": "aws_security_group[{{db_sg}}].egress",
					"search_line": 109,
					"search_value": "",
					"expected_value": "aws_security_group[{{db_sg}}].egress description should be defined and not null",
					"actual_value": "aws_security_group[{{db_sg}}].egress description is undefined or null"
				},
				{
					"file_name": "gpt-4o_0.7_aws-refarch-wordpress_2025-01-14_09-53-00.tf",
					"similarity_id": "9d5b49a71c8e877dd761d41d54bdb2f0f3c7a73de8c46df628922db0ef5d2d28",
					"line": 103,
					"resource_type": "aws_security_group",
					"resource_name": "DatabaseSG",
					"issue_type": "MissingAttribute",
					"search_key": "aws_security_group[{{db_sg}}].ingress",
					"search_line": 103,
					"search_value": "",
					"expected_value": "aws_security_group[{{db_sg}}].ingress description should be defined and not null",
					"actual_value": "aws_security_group[{{db_sg}}].ingress description is undefined or null"
				},
				{
					"file_name": "gpt-4o_0.7_aws-refarch-wordpress_2025-01-14_09-53-00.tf",
					"similarity_id": "6f191a6ac4ad59df6543e35f838263d660bbcedc778258d68802f84ce159e037",
					"line": 84,
					"resource_type": "aws_security_group",
					"resource_name": "WebServerSG",
					"issue_type": "MissingAttribute",
					"search_key": "aws_security_group[{{web_sg}}].ingress",
					"search_line": 84,
					"search_value": "",
					"expected_value": "aws_security_group[{{web_sg}}].ingress description should be defined and not null",
					"actual_value": "aws_security_group[{{web_sg}}].ingress description is undefined or null"
				},
				{
					"file_name": "gpt-4o_0.7_aws-refarch-wordpress_2025-01-14_09-53-00.tf",
					"similarity_id": "42ce1632c332e6883cd0446d3026f6a550147cc87df4f533f397bfb8d2663413",
					"line": 78,
					"resource_type": "aws_security_group",
					"resource_name": "WebServerSG",
					"issue_type": "MissingAttribute",
					"search_key": "aws_security_group[{{web_sg}}].ingress",
					"search_line": 78,
					"search_value": "",
					"expected_value": "aws_security_group[{{web_sg}}].ingress description should be defined and not null",
					"actual_value": "aws_security_group[{{web_sg}}].ingress description is undefined or null"
				},
				{
					"file_name": "gpt-4o_0.7_aws-refarch-wordpress_2025-01-14_09-53-00.tf",
					"similarity_id": "dd141128541145a40a0077afc42e4b7f27417e4390bc21ca3229818b88fd8e83",
					"line": 90,
					"resource_type": "aws_security_group",
					"resource_name": "WebServerSG",
					"issue_type": "MissingAttribute",
					"search_key": "aws_security_group[{{web_sg}}].egress",
					"search_line": 90,
					"search_value": "",
					"expected_value": "aws_security_group[{{web_sg}}].egress description should be defined and not null",
					"actual_value": "aws_security_group[{{web_sg}}].egress description is undefined or null"
				}
			]
		},
		{
			"query_name": "Security Group Without Description",
			"query_id": "cb3f5ed6-0d18-40de-a93d-b3538db31e8c",
			"query_url": "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group#description",
			"severity": "INFO",
			"platform": "Terraform",
			"cwe": "710",
			"cloud_provider": "AWS",
			"category": "Best Practices",
			"experimental": false,
			"description": "It's considered a best practice for AWS Security Group to have a description",
			"description_id": "bc535d27",
			"files": [
				{
					"file_name": "gpt-4o_0.7_aws-refarch-wordpress_2025-01-14_09-53-00.tf",
					"similarity_id": "6fc70e3e12878de8ea8ee33d96c9b097d53eac18ede5e60fdd72aeed52bc0df8",
					"line": 101,
					"resource_type": "aws_security_group",
					"resource_name": "DatabaseSG",
					"issue_type": "MissingAttribute",
					"search_key": "aws_security_group[{{db_sg}}]",
					"search_line": -1,
					"search_value": "",
					"expected_value": "aws_security_group[{{db_sg}}] description should be defined and not null",
					"actual_value": "aws_security_group[{{db_sg}}] description is undefined or null"
				},
				{
					"file_name": "gpt-4o_0.7_aws-refarch-wordpress_2025-01-14_09-53-00.tf",
					"similarity_id": "0aed52ec2a5a7697ed299a59a10773567bce2268116f4fc9d9dab21754a9793e",
					"line": 76,
					"resource_type": "aws_security_group",
					"resource_name": "WebServerSG",
					"issue_type": "MissingAttribute",
					"search_key": "aws_security_group[{{web_sg}}]",
					"search_line": -1,
					"search_value": "",
					"expected_value": "aws_security_group[{{web_sg}}] description should be defined and not null",
					"actual_value": "aws_security_group[{{web_sg}}] description is undefined or null"
				}
			]
		}
	]
}
